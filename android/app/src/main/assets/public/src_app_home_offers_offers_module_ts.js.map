{"version":3,"file":"src_app_home_offers_offers_module_ts.js","mappings":"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","sources":["./src/app/home/offers/offer-item/offer-item.component.ts","./src/app/home/offers/offers-routing.module.ts","./src/app/home/offers/offers.module.ts","./src/app/home/offers/offers.page.ts"],"sourcesContent":["import { Component, OnInit, Input } from '@angular/core';\nimport { Productos } from 'src/app/pruebas/pedido/producto.model';\nimport { Place } from '../../place.model';\n\n@Component({\n  selector: 'app-offer-item',\n  templateUrl: './offer-item.component.html',\n  styleUrls: ['./offer-item.component.scss'],\n})\nexport class OfferItemComponent implements OnInit {\n  @Input() offer: Productos;\n\n  constructor() { }\n\n  ngOnInit() {}\n\n  getDummyDate(){\n    return new Date();\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { OffersPage } from './offers.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: OffersPage\n  },\n  {\n    path: 'new-offer',\n    loadChildren: () => import('./new-offer/new-offer.module').then( m => m.NewOfferPageModule)\n  },\n  {\n    path: 'place-bookings',\n    loadChildren: () => import('./place-bookings/place-bookings.module').then( m => m.PlaceBookingsPageModule)\n  },\n  {\n    path: 'edit-offer',\n    loadChildren: () => import('./edit-offer/edit-offer.module').then( m => m.EditOfferPageModule)\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class OffersPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { OffersPageRoutingModule } from './offers-routing.module';\n\nimport { OffersPage } from './offers.page';\nimport { OfferItemComponent } from './offer-item/offer-item.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    OffersPageRoutingModule\n  ],\n  declarations: [OffersPage, OfferItemComponent]\n})\nexport class OffersPageModule {}\n","/* eslint-disable max-len */\nimport { Component, OnDestroy, OnInit } from '@angular/core';\nimport { NavigationEnd, Router } from '@angular/router';\nimport { AlertController, InfiniteScrollCustomEvent, IonItemSliding, LoadingController } from '@ionic/angular';\nimport { Subscription } from 'rxjs';\nimport { AuthService } from 'src/app/auth/auth.service';\nimport { Restaurantes } from 'src/app/interfaces/restaurantes';\nimport { Productos } from 'src/app/pruebas/pedido/producto.model';\nimport { Place } from '../place.model';\nimport { PlacesService } from '../places.service';\n\n@Component({\n  selector: 'app-offers',\n  templateUrl: './offers.page.html',\n  styleUrls: ['./offers.page.scss'],\n})\nexport class OffersPage implements OnDestroy {\n  products: Productos[] = [];\n  someSubscription: any;\n\n  constructor(\n    private placesService: PlacesService,\n    private router: Router,\n    private authService: AuthService,\n    private alertController: AlertController) {\n  }\n\n  ionViewWillEnter(){\n    let id = parseInt(this.authService.userId)\n    this.getProductsById(id);    \n  }\n\n  getProductsById(restaurant: number){\n    //convertir datos json del servidor a string\n    this.placesService.getProductsByID(restaurant).subscribe(\n      (resp) => {\n        const listString = JSON.stringify(resp);\n        //lista todos los productos\n        this.products = JSON.parse(listString);\n      },\n      (err) => {\n        console.log(err.message);\n      }\n    );\n  }\n\n  onClickItem(i: any){\n    this.router.navigate(['/pruebas/pedido/'+i]);\n  }\n\n  onEdit(offerId: number, slidingItem: IonItemSliding){\n    slidingItem.close();\n    this.router.navigate(['/', 'home', 'tabs', 'offers', 'edit', offerId]);\n    console.log('editing item', offerId);\n  }\n\n  onDelete(offerId: number, slidingItem: IonItemSliding){\n    slidingItem.close();\n    console.log('[SUCCESS] deleting item', offerId);\n    //convert to number\n    const id = +offerId;\n    this.placesService.deleteProduct(id).subscribe();\n    this.ionViewWillEnter();\n    this.reload();\n    \n  }\n\n  reload(){\n    this.router.routeReuseStrategy.shouldReuseRoute = function () {\n      return false;\n    };\n    this.someSubscription = this.router.events.subscribe((event) => {\n      if (event instanceof NavigationEnd) {\n        // Here is the dashing line comes in the picture.\n        // You need to tell the router that, you didn't visit or load the page previously, so mark the navigated flag to false as below.\n        this.router.navigated = false;\n      }\n    });\n  }\n\n  async presentAlert(offerId: number, slidingItem: IonItemSliding){\n    const alert = await this.alertController.create({\n      header: 'Are you sure you want to delete this offer?',\n      buttons: [\n        {\n          text: 'Cancel',\n          role: 'cancel'\n        },\n        {\n          text: 'OK',\n          role: 'confirm'\n        },\n      ],\n    });\n\n    await alert.present();\n\n    const { role } = await alert.onDidDismiss();\n    console.log('ROLE: '+role);\n    if(role==='confirm'){\n      this.onDelete(offerId, slidingItem);\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.someSubscription) {\n      this.someSubscription.unsubscribe();\n    }\n  }\n\n  handleRefresh(event) {\n    setTimeout(() => {\n      this.products.splice(0, this.products.length);\n      let id = parseInt(this.authService.userId)\n      this.getProductsById(id);    \n      event.target.complete();\n    }, 2000);\n  }\n}\n"],"names":["Component","NavigationEnd","Router","AlertController","AuthService","PlacesService","OffersPage","constructor","placesService","router","authService","alertController","ionViewWillEnter","id","parseInt","userId","getProductsById","restaurant","getProductsByID","subscribe","resp","listString","JSON","stringify","products","parse","err","console","log","message","onClickItem","i","navigate","onEdit","offerId","slidingItem","close","onDelete","deleteProduct","reload","routeReuseStrategy","shouldReuseRoute","someSubscription","events","event","navigated","presentAlert","alert","create","header","buttons","text","role","present","onDidDismiss","ngOnDestroy","unsubscribe","handleRefresh","setTimeout","splice","length","target","complete","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}