{"version":3,"file":"src_app_home_discover_discover_module_ts.js","mappings":"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","sources":["./src/app/home/discover/discover-routing.module.ts","./src/app/home/discover/discover.module.ts","./src/app/home/discover/discover.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { DiscoverPage } from './discover.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: DiscoverPage\n  },\n  {\n    path: 'place-detail',\n    loadChildren: () => import('./place-detail/place-detail.module').then( m => m.PlaceDetailPageModule)\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class DiscoverPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { DiscoverPageRoutingModule } from './discover-routing.module';\n\nimport { DiscoverPage } from './discover.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    DiscoverPageRoutingModule\n  ],\n  declarations: [DiscoverPage]\n})\nexport class DiscoverPageModule {}\n","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { InfiniteScrollCustomEvent, LoadingController } from '@ionic/angular';\nimport { Subscription } from 'rxjs';\nimport { AuthService } from 'src/app/auth/auth.service';\nimport { Place } from '../place.model';\nimport { PlacesService } from '../places.service';\n\n@Component({\n  selector: 'app-discover',\n  templateUrl: './discover.page.html',\n  styleUrls: ['./discover.page.scss'],\n})\nexport class DiscoverPage implements OnInit, OnDestroy {\n  //NEW\n  places: Place[];\n  //PAST PROJECT\n  loadedPlaces: Place[];\n  bookable: Place[];\n  relevant: Place[];\n  filter = 'all';\n  userId = 'new';\n  private placesSub: Subscription;\n\n  constructor(private placesService: PlacesService, private authService: AuthService, private loadingController: LoadingController) { }\n\n  ngOnInit() {\n    this.placesSub = this.placesService.places.subscribe(places => {\n      this.loadedPlaces = places;\n      this.onFilterUpdate(this.filter);\n    });\n  }\n\n  onFilterUpdate(filter: string){\n    const isShown = place => filter === 'all' || place.userId !== this.authService.userId;\n    this.relevant = this.loadedPlaces.filter(isShown);\n    this.userId = this.authService.userId;\n    this.filter = filter;\n    console.log('value it: ' + this.filter);\n  }\n\n  ionViewWillEnter() {\n    this.loadPlaces();\n  }\n\n  async loadPlaces(event?: InfiniteScrollCustomEvent) {\n    const loading = await this.loadingController.create({\n      message: 'Loading...',\n      spinner: 'bubbles'\n    }\n    );\n    await loading.present();\n    //convertir data json recibido del servidor a string\n    this.placesService.listPlaces().subscribe(\n      (resp) => {\n        loading.dismiss();\n        const listString = JSON.stringify(resp);\n        //lista todos los lugares\n        this.places = JSON.parse(listString);\n        //lista solos los que puede hacer reservacion\n        this.bookable = JSON.parse(listString);\n        console.log('userId: ' + this.authService.userId);\n        //let j=0;\n        for (let i = 0; i < this.bookable.length; i++) {\n          console.log('JSON Places ' + i + ': ' + this.bookable[i].title);\n\n          if (this.bookable[i].userId === this.authService.userId) {\n            console.log('entro a filtro '+this.bookable[i].title);\n            this.bookable.splice(i,i);\n            if(i!==0){i--;}\n          }\n\n        }\n        event?.target.complete();\n      },\n      (err) => {\n        console.log(err.message);\n        loading.dismiss();\n      }\n    );\n  }\n\n  ngOnDestroy(): void {\n    if (this.placesSub) {\n      this.placesSub.unsubscribe();\n    }\n  }\n\n}\n"],"names":["Component","LoadingController","AuthService","PlacesService","DiscoverPage","constructor","placesService","authService","loadingController","ngOnInit","placesSub","places","subscribe","loadedPlaces","onFilterUpdate","filter","isShown","place","userId","relevant","console","log","ionViewWillEnter","loadPlaces","event","loading","create","message","spinner","present","listPlaces","resp","dismiss","listString","JSON","stringify","parse","bookable","i","length","title","splice","target","complete","err","ngOnDestroy","unsubscribe","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}