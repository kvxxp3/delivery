{"version":3,"file":"src_app_home_offers_offers_module_ts.js","mappings":"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","sources":["./src/app/home/offers/offer-item/offer-item.component.ts","./src/app/home/offers/offers-routing.module.ts","./src/app/home/offers/offers.module.ts","./src/app/home/offers/offers.page.ts"],"sourcesContent":["import { Component, OnInit, Input } from '@angular/core';\nimport { Place } from '../../place.model';\n\n@Component({\n  selector: 'app-offer-item',\n  templateUrl: './offer-item.component.html',\n  styleUrls: ['./offer-item.component.scss'],\n})\nexport class OfferItemComponent implements OnInit {\n  @Input() offer: Place;\n\n  constructor() { }\n\n  ngOnInit() {}\n\n  getDummyDate(){\n    return new Date();\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { OffersPage } from './offers.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: OffersPage\n  },\n  {\n    path: 'new-offer',\n    loadChildren: () => import('./new-offer/new-offer.module').then( m => m.NewOfferPageModule)\n  },\n  {\n    path: 'place-bookings',\n    loadChildren: () => import('./place-bookings/place-bookings.module').then( m => m.PlaceBookingsPageModule)\n  },\n  {\n    path: 'edit-offer',\n    loadChildren: () => import('./edit-offer/edit-offer.module').then( m => m.EditOfferPageModule)\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class OffersPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { OffersPageRoutingModule } from './offers-routing.module';\n\nimport { OffersPage } from './offers.page';\nimport { OfferItemComponent } from './offer-item/offer-item.component';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    OffersPageRoutingModule\n  ],\n  declarations: [OffersPage, OfferItemComponent]\n})\nexport class OffersPageModule {}\n","/* eslint-disable max-len */\nimport { Component, OnDestroy, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AlertController, InfiniteScrollCustomEvent, IonItemSliding, LoadingController } from '@ionic/angular';\nimport { Subscription } from 'rxjs';\nimport { AuthService } from 'src/app/auth/auth.service';\nimport { Place } from '../place.model';\nimport { PlacesService } from '../places.service';\n\n@Component({\n  selector: 'app-offers',\n  templateUrl: './offers.page.html',\n  styleUrls: ['./offers.page.scss'],\n})\nexport class OffersPage implements OnInit, OnDestroy {\n  //FALTA AGREGAR METODOS DE VALIDACION PARA COMPROBRAR QUE LOS LUGARES LISTADOS TENGAN COMO\n  //AUTOR EL USUARIO DE LA SESION INICIADA\n  places: Place[];\n  offers: Place[];\n  sub: Place[];\n  private placesSub: Subscription;\n\n  constructor(private placesService: PlacesService, private router: Router, private loadingController: LoadingController, private authService: AuthService, private alertController: AlertController) { }\n\n  ngOnInit() {\n    this.placesSub = this.placesService.places.subscribe(places => {\n      this.sub = places;\n    });\n  }\n\n  ionViewWillEnter(){\n    this.loadPlaces();\n  }\n\n  async loadPlaces(event?: InfiniteScrollCustomEvent) {\n    const loading = await this.loadingController.create({\n      message: 'Loading...',\n      spinner: 'bubbles'\n    }\n    );\n    await loading.present();\n    //convertir data json recibido del servidor a string\n    this.placesService.listPlaces().subscribe(\n      (resp) => {\n        loading.dismiss();\n        const listString = JSON.stringify(resp);\n        this.offers = JSON.parse(listString);\n        console.log('userId: ' + this.authService.userId);\n        //muestra solo los lugares que registro el usuario\n        for (let i = 0; i < this.offers.length; i++) {\n          console.log('JSON Places ' + i + ': ' + this.offers[i].title);\n          let j=i;\n          if (this.offers[i].userId !== this.authService.userId) {\n            if(i===0){j=1;}\n            console.log('entro a filtro '+this.offers[i].title);\n            this.offers.splice(i,j);\n            if(i!==0){i--;}\n          }\n\n        }\n        //GUARDADOS\n        for (let i = 0; i < this.offers.length; i++) {\n          console.log('GUARDADOS\\nJSON Places ' + i + ': ' + this.offers[i].title);\n        }\n        event?.target.complete();\n      },\n      (err) => {\n        console.log(err.message);\n        loading.dismiss();\n      }\n    );\n  }\n\n  onEdit(offerId: string, slidingItem: IonItemSliding){\n    slidingItem.close();\n    this.router.navigate(['/', 'home', 'tabs', 'offers', 'edit', offerId]);\n    console.log('editing item', offerId);\n  }\n\n  onDelete(offerId: string, slidingItem: IonItemSliding){\n    slidingItem.close();\n    console.log('[SUCCESS] deleting item', offerId);\n    //convert to number\n    const id = +offerId;\n    this.placesService.deletePlace(id).subscribe();\n    this.ionViewWillEnter();\n    //this.router.navigateByUrl('/home/tabs/offers');\n    //this.router.navigate(['/', 'home', 'tabs', 'offers']);\n  }\n\n  async presentAlert(offerId: string, slidingItem: IonItemSliding){\n    const alert = await this.alertController.create({\n      header: 'Are you sure you want to delete this offer?',\n      buttons: [\n        {\n          text: 'Cancel',\n          role: 'cancel'\n        },\n        {\n          text: 'OK',\n          role: 'confirm'\n        },\n      ],\n    });\n\n    await alert.present();\n\n    const { role } = await alert.onDidDismiss();\n    console.log('ROLE: '+role);\n    if(role==='confirm'){\n      this.onDelete(offerId, slidingItem);\n    }\n  }\n\n  ngOnDestroy(): void {\n    if(this.placesSub){\n      this.placesSub.unsubscribe();\n    }\n  }\n}\n"],"names":["Component","Router","AlertController","LoadingController","AuthService","PlacesService","OffersPage","constructor","placesService","router","loadingController","authService","alertController","ngOnInit","placesSub","places","subscribe","sub","ionViewWillEnter","loadPlaces","event","loading","create","message","spinner","present","listPlaces","resp","dismiss","listString","JSON","stringify","offers","parse","console","log","userId","i","length","title","j","splice","target","complete","err","onEdit","offerId","slidingItem","close","navigate","onDelete","id","deletePlace","presentAlert","alert","header","buttons","text","role","onDidDismiss","ngOnDestroy","unsubscribe","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}